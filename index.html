<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nin Online - Guia de Builds</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #e5e7eb; /* bg-gray-200 */
            color: #e5e7eb; /* text-gray-200 */
        }
        .custom-select {
            appearance: none;
            -webkit-appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%239ca3af' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
        select:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        option:disabled {
            color: #6b7280;
        }
        /* Animação de fade-in */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out forwards;
        }
        /* Custom scrollbar for Jutsu list */
        .jutsu-scroll::-webkit-scrollbar {
            width: 8px;
        }
        .jutsu-scroll::-webkit-scrollbar-track {
            background-color: #334155; /* slate-700 */
            border-radius: 10px;
        }
        .jutsu-scroll::-webkit-scrollbar-thumb {
            background-color: #64748b; /* slate-500 */
            border-radius: 10px;
        }
        .jutsu-scroll::-webkit-scrollbar-thumb:hover {
            background-color: #94a3b8; /* slate-400 */
        }
        .lang-btn.active {
            background-color: #ea580c; /* orange-600 */
            color: #ffffff;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 pt-8">

    <div class="w-full max-w-5xl bg-slate-800 rounded-2xl shadow-lg p-6 md:p-8 relative">
        <!-- Language Switcher -->
        <div class="absolute top-4 right-6 flex items-center space-x-2 text-sm">
            <button data-lang="pt-BR" class="lang-btn px-2 py-1 rounded font-semibold transition-colors">PT-BR</button>
            <span class="text-slate-600">|</span>
            <button data-lang="en" class="lang-btn px-2 py-1 rounded font-semibold transition-colors">EN</button>
        </div>

        <!-- Cabeçalho -->
        <header class="text-center mb-8 pt-8 md:pt-0">
            <h1 class="text-3xl md:text-4xl font-bold text-orange-400" data-translate-key="headerTitle">Guia de Builds - Nin Online</h1>
            <p class="text-slate-400 mt-2" data-translate-key="headerSubtitle">Encontre a build recomendada para sua combinação de maestrias.</p>
        </header>

        <!-- Seção de Seleção de Maestrias -->
        <div class="bg-slate-900/50 p-6 rounded-lg mb-8 border border-slate-700">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end">
                <div class="md-col-span-1">
                    <label for="mastery1" class="block text-sm font-medium text-slate-300 mb-2" data-translate-key="mastery1Label">Maestria Principal</label>
                    <select id="mastery1" class="w-full bg-slate-700 border border-slate-600 rounded-md p-2 focus:ring-orange-500 focus:border-orange-500 custom-select"></select>
                </div>
                <div class="md:col-span-1">
                    <label for="mastery2" class="block text-sm font-medium text-slate-300 mb-2" data-translate-key="mastery2Label">Maestria Secundária</label>
                    <select id="mastery2" class="w-full bg-slate-700 border border-slate-600 rounded-md p-2 focus:ring-orange-500 focus:border-orange-500 custom-select" disabled></select>
                </div>
                <div class="md:col-span-1">
                    <button id="find-build-btn" class="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded-lg transition-colors h-10 disabled:bg-slate-600 disabled:cursor-not-allowed" data-translate-key="findBuildBtn">Buscar Build</button>
                </div>
            </div>
        </div>

        <!-- Seção de Status da Build -->
        <div id="build-status-overview" class="hidden bg-slate-900/50 p-4 rounded-lg mb-6 border border-slate-700">
            <div class="grid grid-cols-1 md:grid-cols-2 md:gap-x-8 gap-y-4">
                <!-- Left Column: Build Status & Info -->
                <div>
                    <h3 class="text-lg font-semibold text-slate-300 mb-3" data-translate-key="buildStatusTitle">Status da Build</h3>
                    <div class="space-y-2">
                        <div class="flex items-center">
                            <span class="font-medium text-slate-400 mr-2 w-20" data-translate-key="statusAttributes">Atributos:</span>
                            <span id="status-attributes-badge" class="px-2 py-0.5 text-xs font-bold rounded-full"></span>
                        </div>
                        <div class="flex items-center">
                            <span class="font-medium text-slate-400 mr-2 w-20" data-translate-key="statusJutsus">Jutsus:</span>
                            <span id="status-jutsus-badge" class="px-2 py-0.5 text-xs font-bold rounded-full"></span>
                        </div>
                        <div class="flex items-center">
                            <span class="font-medium text-slate-400 mr-2 w-20" data-translate-key="statusItems">Itens:</span>
                            <span id="status-items-badge" class="px-2 py-0.5 text-xs font-bold rounded-full"></span>
                        </div>
                    </div>
                     <div id="build-info-section" class="hidden mt-4 pt-4 border-t border-slate-700/50">
                         <div class="flex text-sm">
                            <span class="font-medium text-slate-400 w-20" data-translate-key="buildVersionLabel">Versão:</span>
                            <span id="build-version" class="text-slate-300"></span>
                        </div>
                         <div class="flex text-sm">
                            <span class="font-medium text-slate-400 w-20" data-translate-key="buildDateLabel">Data:</span>
                            <span id="build-date" class="text-slate-300"></span>
                        </div>
                    </div>
                </div>
                <!-- Right Column: Created By -->
                <div id="created-by-section" class="hidden md:border-l md:border-slate-700 md:pl-8">
                    <h3 class="text-lg font-semibold text-slate-300 mb-3" data-translate-key="createdByTitle">Criado por:</h3>
                    <div class="space-y-1 text-sm">
                        <div class="flex">
                            <span class="font-medium text-slate-400 w-24" data-translate-key="creatorNameLabel">Nome:</span>
                            <span id="creator-name" class="font-bold text-orange-400"></span>
                        </div>
                         <div class="flex">
                            <span class="font-medium text-slate-400 w-24" data-translate-key="creatorVillageLabel">Vila:</span>
                            <span id="creator-village" class="text-slate-300"></span>
                        </div>
                         <div class="flex">
                            <span class="font-medium text-slate-400 w-24" data-translate-key="creatorRankLabel">Rank:</span>
                            <span id="creator-rank" class="text-slate-300"></span>
                        </div>
                         <div class="flex">
                            <span class="font-medium text-slate-400 w-24" data-translate-key="creatorOrgLabel">Organização:</span>
                            <span id="creator-org" class="text-slate-300"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- Seção de Resultados da Build -->
        <div id="build-results" class="hidden space-y-8">
            <!-- 1. Atributos por Nível -->
            <section id="attributes-section">
                <h2 class="text-2xl font-bold text-slate-200 mb-4 border-b-2 border-orange-500 pb-2" data-translate-key="attributesTitle">Atributos Recomendados</h2>
                
                <div class="flex flex-wrap items-center justify-between mb-4">
                    <div id="attribute-focus-container" class="hidden items-center">
                        <label for="attribute-focus-select" class="text-sm font-medium text-slate-300 mr-4" data-translate-key="focusLabel">Foco da Build:</label>
                        <select id="attribute-focus-select" class="w-52 bg-slate-700 border border-slate-600 rounded-md p-2 focus:ring-orange-500 focus:border-orange-500 custom-select"></select>
                    </div>
                    <div class="flex items-center space-x-2 mt-2 md:mt-0" id="guild-bonus-container" class="hidden">
                         <input type="checkbox" id="guild-bonus-toggle" class="h-4 w-4 rounded bg-slate-700 border-slate-600 text-orange-600 focus:ring-orange-500" checked>
                        <label for="guild-bonus-toggle" id="guild-bonus-legend" class="text-sm text-orange-400 cursor-pointer">
                            <span data-translate-key="guildBonusLegend"></span>
                        </label>
                    </div>
                </div>

                <div class="overflow-x-auto">
                    <table class="w-full bg-slate-900/50 rounded-lg text-center">
                        <thead class="bg-slate-700">
                            <tr>
                                <th class="p-3 text-sm font-semibold tracking-wide text-left text-slate-300" data-translate-key="thLevel">Nível</th>
                                <th class="p-3 text-sm font-semibold tracking-wide text-slate-300" data-translate-key="thStrength">Força</th>
                                <th class="p-3 text-sm font-semibold tracking-wide text-slate-300" data-translate-key="thFortitude">Fortitude</th>
                                <th class="p-3 text-sm font-semibold tracking-wide text-slate-300" data-translate-key="thIntellect">Intelecto</th>
                                <th class="p-3 text-sm font-semibold tracking-wide text-slate-300" data-translate-key="thAgility">Agilidade</th>
                                <th class="p-3 text-sm font-semibold tracking-wide text-slate-300" data-translate-key="thChakra">Chakra</th>
                                <th class="p-3 text-sm font-semibold tracking-wide text-slate-300" data-translate-key="thHealth">Vida</th>
                                <th class="p-3 text-sm font-semibold tracking-wide text-slate-300" data-translate-key="thChakraPool">Chakra</th>
                            </tr>
                        </thead>
                        <tbody id="attributes-table-body" class="divide-y divide-slate-700"></tbody>
                        
                    </table>
                </div>
            </section>

            <!-- 2. Ordem dos Jutsus -->
            <section id="jutsu-section">
                <h2 class="text-2xl font-bold text-slate-200 mb-4 border-b-2 border-orange-500 pb-2" data-translate-key="jutsuTitle">Ordem de Jutsus Sugerida</h2>
                <div class="bg-slate-900/50 rounded-lg overflow-hidden">
                    <div class="max-h-96 overflow-y-auto jutsu-scroll">
                        <table class="min-w-full">
                            <thead class="bg-slate-700 sticky top-0">
                                <tr>
                                    <th class="p-3 text-sm font-semibold tracking-wide text-left w-24 text-slate-300" data-translate-key="thSlot">Slot</th>
                                    <th class="p-3 text-sm font-semibold tracking-wide text-left w-16 text-slate-300" data-translate-key="thLevel">Nível</th>
                                    <th class="p-3 text-sm font-semibold tracking-wide text-left text-slate-300" data-translate-key="thJutsu">Jutsu</th>
                                    <th class="p-3 text-sm font-semibold tracking-wide text-left text-slate-300" data-translate-key="thHowToGet">Como Obter</th>
                                </tr>
                            </thead>
                            <tbody id="jutsu-table-body" class="divide-y divide-slate-700"></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- 3. Itens Recomendados -->
            <section id="items-section">
                <h2 class="text-2xl font-bold text-slate-200 mb-4 border-b-2 border-orange-500 pb-2" data-translate-key="itemsTitle">Itens Recomendados</h2>
                <div class="overflow-x-auto">
                     <table class="min-w-full bg-slate-900/50 rounded-lg">
                        <thead class="bg-slate-700">
                            <tr>
                                <th class="p-3 text-sm font-semibold tracking-wide text-left text-slate-300" data-translate-key="thType">Tipo</th>
                                <th class="p-3 text-sm font-semibold tracking-wide text-left text-slate-300" data-translate-key="thRecommendedItem">Item Recomendado</th>
                                <th class="p-3 text-sm font-semibold tracking-wide text-left text-slate-300" data-translate-key="thDamage">Dano</th>
                                <th class="p-3 text-sm font-semibold tracking-wide text-left text-slate-300" data-translate-key="thAttribute">Atributo</th>
                                <th class="p-3 text-sm font-semibold tracking-wide text-left text-slate-300" data-translate-key="thEffect">Efeito</th>
                                <th class="p-3 text-sm font-semibold tracking-wide text-left text-slate-300" data-translate-key="thObservation">Observação</th>
                            </tr>
                        </thead>
                        <tbody id="items-table-body" class="divide-y divide-slate-700"></tbody>
                    </table>
                </div>
            </section>
        </div>

        <div id="feedback-message" class="hidden text-center p-6 bg-yellow-900/40 text-yellow-300 rounded-lg mt-8 border border-yellow-800"></div>
    </div>

    <footer class="w-full max-w-5xl text-center text-xs text-slate-500 mt-6 pb-6 space-y-2">
        <p data-translate-key="footerDisclaimer">Este é um projeto de fã não oficial e não é afiliado ao Nin Online. Todos os recursos visuais e nomes de jutsus/itens são propriedade de seus respectivos criadores.</p>
        <p>
            <span data-translate-key="footerCreatedBy">Site desenvolvido por Auriosh. </span>
            <span data-translate-key="footerContact">Encontrou um erro ou quer sugerir uma build? Contate @auriosh.</span>
        </p>
         <p data-translate-key="footerAcknowledgements">Agradecimentos especiais a todos os jogadores que contribuem com builds para a comunidade.</p>
    </footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- LÓGICA DE TRADUÇÃO ---
    const translations = {
        'pt-BR': {
            pageTitle: "Nin Online - Guia de Builds", headerTitle: "Guia de Builds - Nin Online", headerSubtitle: "Encontre a build recomendada para sua combinação de maestrias.", mastery1Label: "Maestria Principal", mastery2Label: "Maestria Secundária", findBuildBtn: "Buscar Build", attributesTitle: "Atributos Recomendados", focusLabel: "Foco da Build:", thLevel: "Nível", thStrength: "Força", thFortitude: "Fortitude", thIntellect: "Intelecto", thAgility: "Agilidade", thChakra: "Chakra", thHealth: "Vida", thChakraPool: "Chakra", jutsuTitle: "Ordem de Jutsus Sugerida", thSlot: "Slot", thJutsu: "Jutsu", thHowToGet: "Como Obter", itemsTitle: "Itens Recomendados", thType: "Tipo", thRecommendedItem: "Item Recomendado", thDamage: "Dano", thAttribute: "Atributo", thEffect: "Efeito", thObservation: "Observação", feedbackSelectMastery: "Por favor, selecione pelo menos a maestria principal.", feedbackNotFoundMastery: "Nenhuma build foi encontrada para a maestria: {m1}.", feedbackNotFoundCombination: "Nenhuma build foi encontrada para a combinação: {m1} + {m2}.", guildBonus: "Bônus de Guilda (10%)", otherBonuses: "Outros Bônus", totalLevel: "Total (Nível {level})", slotExtra: "Extra {num}", slotEmpty: "Vazio", focusIntellect: "Intelecto", focusChakra: "Chakra", guildBonusLegend: "Bônus de Guilda (10%)", buildStatusTitle: "Status da Build", statusAttributes: "Atributos:", statusJutsus: "Jutsus:", statusItems: "Itens:", statusOk: "OK", statusPending: "Pendente", createdByTitle: "Criado por:", creatorNameLabel: "Nome:", creatorVillageLabel: "Vila:", creatorRankLabel: "Rank:", creatorOrgLabel: "Organização:", buildVersionLabel: "Versão:", buildDateLabel: "Data:", footerDisclaimer: "Este é um projeto de fã não oficial e não é afiliado ao Nin Online. Todos os recursos visuais e nomes de jutsus/itens são propriedade de seus respectivos criadores.", footerCreatedBy: "Site desenvolvido por Auriosh.", footerContact: "Encontrou um erro ou quer sugerir uma build? Contate @auriosh.", footerAcknowledgements: "Agradecimentos especiais a todos os jogadores que contribuem com builds para a comunidade.", masteryNames: { none: 'Nenhuma', fogo: 'Fogo', agua: 'Água', bolha: 'Bolha (Água)', terra: 'Terra', raio: 'Raio', vento: 'Vento', leque: 'Leque (Vento)', medico: 'Médico', arma: 'Arma', taijutsu: 'Taijutsu', punho_gentil: 'Punho Gentil (Taijutsu)' }, itemTypes: { Weapon: 'Arma', Clothing: 'Roupa', Accessory: 'Acessório' }
        },
        'en': {
            pageTitle: "Nin Online - Build Guide", headerTitle: "Nin Online Build Guide", headerSubtitle: "Find the recommended build for your mastery combination.", mastery1Label: "Main Mastery", mastery2Label: "Secondary Mastery", findBuildBtn: "Find Build", attributesTitle: "Recommended Attributes", focusLabel: "Build Focus:", thLevel: "Level", thStrength: "Strength", thFortitude: "Fortitude", thIntellect: "Intellect", thAgility: "Agility", thChakra: "Chakra", thHealth: "Health", thChakraPool: "Chakra Pool", jutsuTitle: "Suggested Jutsu Order", thSlot: "Slot", thJutsu: "Jutsu", thHowToGet: "How to Get", itemsTitle: "Recommended Items", thType: "Type", thRecommendedItem: "Recommended Item", thDamage: "Damage", thAttribute: "Attribute", thEffect: "Effect", thObservation: "Observation", feedbackSelectMastery: "Please select at least the main mastery.", feedbackNotFoundMastery: "No build was found for the mastery: {m1}.", feedbackNotFoundCombination: "No build was found for the combination: {m1} + {m2}.", guildBonus: "Guild Bonus (10%)", otherBonuses: "Other Bonuses", totalLevel: "Total (Level {level})", slotExtra: "Extra {num}", slotEmpty: "Empty", focusIntellect: "Intellect", focusChakra: "Chakra", guildBonusLegend: "Guild Bonus (10%)", buildStatusTitle: "Build Status", statusAttributes: "Attributes:", statusJutsus: "Jutsus:", statusItems: "Items:", statusOk: "OK", statusPending: "Pending", createdByTitle: "Created by:", creatorNameLabel: "Name:", creatorVillageLabel: "Village:", creatorRankLabel: "Rank:", creatorOrgLabel: "Organization:", buildVersionLabel: "Version:", buildDateLabel: "Date:", footerDisclaimer: "This is an unofficial fan project and is not affiliated with Nin Online. All visual assets and jutsu/item names are property of their respective creators.", footerCreatedBy: "Site developed by Auriosh.", footerContact: "Found a bug or want to suggest a build? Contact @auriosh.", footerAcknowledgements: "Special thanks to all the players who contribute builds to the community.", masteryNames: { none: 'None', fogo: 'Fire', agua: 'Water', bolha: 'Bubble (Water)', terra: 'Earth', raio: 'Lightning', vento: 'Wind', leque: 'Fan (Wind)', medico: 'Medic', arma: 'Weapon', taijutsu: 'Taijutsu', punho_gentil: 'Gentle Fist (Taijutsu)' }, itemTypes: { Weapon: 'Weapon', Clothing: 'Clothing', Accessory: 'Accessory' }
        }
    };

    let currentLang;
    let langStrings;
    let isGuildBonusActive = true;

    // --- DADOS DAS BUILDS ---
    const buildData = {
        'medico': {
            'agua': {
                 version: 'v5.9.9e',
                 date: '18/10/2025',
                 createdBy: {
                    name: 'Auriosh',
                    village: { 'pt-BR': 'Névoa', 'en': 'Mist' },
                    rank: { 'pt-BR': 'Genin', 'en': 'Genin' },
                    org: { 'pt-BR': 'Corporação Médica da Névoa', 'en': 'Mist Medic Corp' }
                },
                items: {
                    'Weapon': { name: { 'pt-BR': "-", 'en': "-" }, dmg: "-", attr: "-", effect: { 'pt-BR': "-", 'en': "-" }, obs: { 'pt-BR': "-", 'en': "-" } },
                    'Clothing': { name: { 'pt-BR': "-", 'en': "-" }, dmg: "-", attr: "-", effect: { 'pt-BR': "-", 'en': "-" }, obs: { 'pt-BR': "-", 'en': "-" } },
                    'Accessory': { name: { 'pt-BR': "-", 'en': "-" }, dmg: "-", attr: "-", effect: { 'pt-BR': "-", 'en': "-" }, obs: { 'pt-BR': "-", 'en': "-" } }
                },
                focuses: {
                    'intellect': {
                        stats: [
                            { level: 1, str: 5, agi: 5, intel: 5, chakra: 5, sta: 5 },
                            { level: 10, str: 5, sta: 21, intel: 25, agi: 5, chakra: 14 },
                            { level: 20, str: 5, sta: 27, intel: 40, agi: 5, chakra: 43 },
                            { level: 30, str: 5, sta: 39, intel: 60, agi: 5, chakra: 61 },
                            { level: 40, str: 5, sta: 67, intel: 82, agi: 5, chakra: 61 },
                            { level: 50, str: 5, sta: 113, intel: 86, agi: 5, chakra: 61 },
                            { level: 60, str: 5, sta: 148, intel: 91, agi: 5, chakra: 61 }
                        ],
                        jutsuOrder: [
                            { level: 1, name: { 'pt-BR': "Body Flicker", 'en': "Body Flicker" }, howToGet: { 'pt-BR': "Começa com o Jutsu", 'en': "Starter Jutsu" } },
                            { level: 1, name: { 'pt-BR': "Substitution", 'en': "Substitution" }, howToGet: { 'pt-BR': "Sealable Scroll I", 'en': "Sealable Scroll I" } },
                            { level: 1, name: { 'pt-BR': "Cloak of Invisibility", 'en': "Cloak of Invisibility" }, howToGet: { 'pt-BR': "Começa com o Jutsu", 'en': "Starter Jutsu" } },
                            { level: 10, name: { 'pt-BR': "Treat Wounds", 'en': "Treat Wounds" }, howToGet: { 'pt-BR': "Sealable Scroll I", 'en': "Sealable Scroll I" } },
                            { level: 10, name: { 'pt-BR': "Poison Senbon", 'en': "Poison Senbon" }, howToGet: { 'pt-BR': "Sealable Scroll I", 'en': "Sealable Scroll I" } },
                            { level: 15, name: { 'pt-BR': "Chakra Scalpel", 'en': "Chakra Scalpel" }, howToGet: { 'pt-BR': "Sealable Scroll I", 'en': "Sealable Scroll I" } },
                            { level: 15, name: { 'pt-BR': "Poison Scalpel", 'en': "Poison Scalpel" }, howToGet: { 'pt-BR': "Sealable Scroll I", 'en': "Sealable Scroll I" } },
                            { level: 20, name: { 'pt-BR': "Mystical Palm", 'en': "Mystical Palm" }, howToGet: { 'pt-BR': "Sealable Scroll II", 'en': "Sealable Scroll II" } },
                            { level: 25, name: { 'pt-BR': "Poison Cloud", 'en': "Poison Cloud" }, howToGet: { 'pt-BR': "Sealable Scroll II", 'en': "Sealable Scroll II" } },
                            { level: 25, name: { 'pt-BR': "Flash Flicker", 'en': "Flash Flicker" }, howToGet: { 'pt-BR': "Sealable Scroll II", 'en': "Sealable Scroll II" } },
                            { level: 30, name: { 'pt-BR': "Cell Regeneration Activation", 'en': "Cell Regeneration Activation" }, howToGet: { 'pt-BR': "Sealable Scroll III", 'en': "Sealable Scroll III" } },
                            { level: 10, name: { 'pt-BR': "Water Bullet > Triple Water Bullet", 'en': "Water Bullet > Triple Water Bullet" }, howToGet: { 'pt-BR': "Sealable Scroll I", 'en': "Sealable Scroll I" } },
                            { level: 15, name: { 'pt-BR': "Water Slash", 'en': "Water Slash" }, howToGet: { 'pt-BR': "Sealable Scroll II", 'en': "Sealable Scroll II" } },
                            { level: 25, name: { 'pt-BR': "Water Substitution", 'en': "Water Substitution" }, howToGet: { 'pt-BR': "Sealable Scroll II", 'en': "Sealable Scroll II" } },
                            { level: 30, name: { 'pt-BR': "Water Prison", 'en': "Water Prison" }, howToGet: { 'pt-BR': "Sealable Scroll III", 'en': "Sealable Scroll III" } },
                            { level: 20, name: { 'pt-BR': "Colliding Wave", 'en': "Colliding Wave" }, howToGet: { 'pt-BR': "Sealable Scroll II", 'en': "Sealable Scroll II" } },
                            { level: 35, name: { 'pt-BR': "Cursed Seal Activation", 'en': "Cursed Seal Activation" }, howToGet: { 'pt-BR': "Sealable Scroll III", 'en': "Sealable Scroll III" } },
                            { level: 1, name: { 'pt-BR': "Med Corp Seal", 'en': "Med Corp Seal" }, howToGet: { 'pt-BR': "Med Corp", 'en': "Medic Corp" } },
                            { level: 30, name: { 'pt-BR': "Sticky Venom", 'en': "Sticky Venom" }, howToGet: { 'pt-BR': "Pode ser trocado por Chakra Scalpel", 'en': "Can be swapped for Chakra Scalpel" } },
                        ]
                    },
                    'chakra': {
                        stats: [
                            { level: 1, str: 5, agi: 5, intel: 5, chakra: 5, sta: 5 },
                            { level: 10, str: 5, agi: 5, intel: 25, chakra: 14, sta: 21 },
                            { level: 20, str: 5, agi: 5, intel: 35, chakra: 36, sta: 39 },
                            { level: 30, str: 5, agi: 5, intel: 40, chakra: 61, sta: 59 },
                            { level: 40, str: 5, agi: 5, intel: 40, chakra: 87, sta: 83 },
                            { level: 50, str: 5, agi: 5, intel: 50, chakra: 105, sta: 105 },
                            { level: 60, str: 5, agi: 5, intel: 65, chakra: 122, sta: 113 }
                        ],
                        jutsuOrder: [
                            { level: 1, name: { 'pt-BR': "Body Flicker", 'en': "Body Flicker" }, howToGet: { 'pt-BR': "Começa com o Jutsu", 'en': "Starter Jutsu" } },
                            { level: 1, name: { 'pt-BR': "Substitution", 'en': "Substitution" }, howToGet: { 'pt-BR': "Sealable Scroll I", 'en': "Sealable Scroll I" } },
                            { level: 1, name: { 'pt-BR': "Cloak of Invisibility", 'en': "Cloak of Invisibility" }, howToGet: { 'pt-BR': "Começa com o Jutsu", 'en': "Starter Jutsu" } },
                            { level: 10, name: { 'pt-BR': "Treat Wounds", 'en': "Treat Wounds" }, howToGet: { 'pt-BR': "Sealable Scroll I", 'en': "Sealable Scroll I" } },
                            { level: 10, name: { 'pt-BR': "Poison Senbon", 'en': "Poison Senbon" }, howToGet: { 'pt-BR': "Sealable Scroll I", 'en': "Sealable Scroll I" } },
                            { level: 15, name: { 'pt-BR': "Chakra Scalpel", 'en': "Chakra Scalpel" }, howToGet: { 'pt-BR': "Sealable Scroll I", 'en': "Sealable Scroll I" } },
                            { level: 15, name: { 'pt-BR': "Poison Scalpel", 'en': "Poison Scalpel" }, howToGet: { 'pt-BR': "Sealable Scroll I", 'en': "Sealable Scroll I" } },
                            { level: 20, name: { 'pt-BR': "Mystical Palm", 'en': "Mystical Palm" }, howToGet: { 'pt-BR': "Sealable Scroll II", 'en': "Sealable Scroll II" } },
                            { level: 25, name: { 'pt-BR': "Poison Cloud", 'en': "Poison Cloud" }, howToGet: { 'pt-BR': "Sealable Scroll II", 'en': "Sealable Scroll II" } },
                            { level: 25, name: { 'pt-BR': "Flash Flicker", 'en': "Flash Flicker" }, howToGet: { 'pt-BR': "Sealable Scroll II", 'en': "Sealable Scroll II" } },
                            { level: 30, name: { 'pt-BR': "Cell Regeneration Activation", 'en': "Cell Regeneration Activation" }, howToGet: { 'pt-BR': "Sealable Scroll III", 'en': "Sealable Scroll III" } },
                            { level: 10, name: { 'pt-BR': "Water Bullet > Triple Water Bullet", 'en': "Water Bullet > Triple Water Bullet" }, howToGet: { 'pt-BR': "Sealable Scroll I", 'en': "Sealable Scroll I" } },
                            { level: 15, name: { 'pt-BR': "Water Slash", 'en': "Water Slash" }, howToGet: { 'pt-BR': "Sealable Scroll II", 'en': "Sealable Scroll II" } },
                            { level: 25, name: { 'pt-BR': "Water Substitution", 'en': "Water Substitution" }, howToGet: { 'pt-BR': "Sealable Scroll II", 'en': "Sealable Scroll II" } },
                            { level: 30, name: { 'pt-BR': "Water Prison", 'en': "Water Prison" }, howToGet: { 'pt-BR': "Sealable Scroll III", 'en': "Sealable Scroll III" } },
                            { level: 20, name: { 'pt-BR': "Colliding Wave", 'en': "Colliding Wave" }, howToGet: { 'pt-BR': "Sealable Scroll II", 'en': "Sealable Scroll II" } },
                            { level: 35, name: { 'pt-BR': "Cursed Seal Activation", 'en': "Cursed Seal Activation" }, howToGet: { 'pt-BR': "Sealable Scroll III", 'en': "Sealable Scroll III" } },
                            { level: 1, name: { 'pt-BR': "Med Corp Seal", 'en': "Med Corp Seal" }, howToGet: { 'pt-BR': "Med Corp", 'en': "Medic Corp" } },
                            { level: 20, name: { 'pt-BR': "Sensory", 'en': "Sensory" }, howToGet: { 'pt-BR': "Pode ser trocado por Chakra Scalpel", 'en': "Can be swapped for Chakra Scalpel" } },
                        ]
                    }
                }
            }
        }
    };

    // --- LÓGICA DA PÁGINA ---
    const mastery1Select = document.getElementById('mastery1');
    const mastery2Select = document.getElementById('mastery2');
    const findBuildBtn = document.getElementById('find-build-btn');
    const buildResultsDiv = document.getElementById('build-results');
    const feedbackMessageDiv = document.getElementById('feedback-message');
    const jutsuTableBody = document.getElementById('jutsu-table-body');
    const itemsTableBody = document.getElementById('items-table-body');
    const exclusiveMasteries = ['bolha', 'leque', 'punho_gentil'];
    const specializationMap = { 'agua': 'bolha', 'vento': 'leque', 'taijutsu': 'punho_gentil', 'bolha': 'agua', 'leque': 'vento', 'punho_gentil': 'taijutsu' };
    let currentDisplayedBuild = null;
    const focusContainer = document.getElementById('attribute-focus-container');
    const focusSelect = document.getElementById('attribute-focus-select');
    const guildBonusToggle = document.getElementById('guild-bonus-toggle');

    function setLanguage(lang) {
        currentLang = lang;
        langStrings = translations[currentLang];
        localStorage.setItem('ninBuildsLang', currentLang);

        applyTranslations();
        populateMasterySelects();
        updateLangSwitcherUI();

        if (!buildResultsDiv.classList.contains('hidden') && currentDisplayedBuild) {
            displayBuild(currentDisplayedBuild);
        }
    }

    function updateLangSwitcherUI() {
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.classList.remove('active');
            if (btn.dataset.lang === currentLang) {
                btn.classList.add('active');
            }
        });
    }

    function applyTranslations() {
        document.querySelectorAll('[data-translate-key]').forEach(el => {
            const key = el.getAttribute('data-translate-key');
            if (langStrings[key]) {
                el.textContent = langStrings[key];
            }
        });
        document.title = langStrings.pageTitle;
    }
    
    function populateMasterySelects() {
        const currentM1 = mastery1Select.value;
        const currentM2 = mastery2Select.value;
        
        mastery1Select.innerHTML = '';
        const masteryOptions = Object.keys(langStrings.masteryNames);
        masteryOptions.forEach(key => {
            const option1 = document.createElement('option');
            option1.value = key;
            option1.textContent = langStrings.masteryNames[key];
            mastery1Select.appendChild(option1);
        });
        mastery1Select.value = currentM1 || 'none';

        mastery2Select.innerHTML = '';
        masteryOptions.forEach(key => {
            const option2 = document.createElement('option');
            option2.value = key;
            option2.textContent = langStrings.masteryNames[key];
            mastery2Select.appendChild(option2);
        });

        if (currentM1 === 'none' || !currentM1) {
            mastery2Select.disabled = true;
        } else {
            mastery2Select.disabled = false;
            const isPrimaryExclusive = exclusiveMasteries.includes(currentM1);
            const relatedSpecialization = specializationMap[currentM1];
            Array.from(mastery2Select.options).forEach(option => {
                const isOptionExclusive = exclusiveMasteries.includes(option.value);
                if (option.value === currentM1 || (isPrimaryExclusive && isOptionExclusive) || option.value === relatedSpecialization) {
                    option.remove();
                }
            });
        }
        
        mastery2Select.value = currentM2 || 'none';
        
        updateMasteryAvailability();
        updateFindButtonState();
    }
    
    function getTranslated(obj, key) {
        if (typeof obj === 'object' && obj !== null && obj[key] !== undefined) {
            if (typeof obj[key] === 'object' && obj[key] !== null) {
                return obj[key][currentLang] || obj[key]['pt-BR'];
            }
            return obj[key];
        }
        return '-';
    }

    function updateFindButtonState() {
        const m1 = mastery1Select.value;
        const m2 = mastery2Select.value;
        if (m1 === 'none') {
            findBuildBtn.disabled = true;
            return;
        }
        const buildExists = buildData[m1] && buildData[m1][m2];
        findBuildBtn.disabled = !buildExists;
    }

    function updateMasteryAvailability() {
        const m1Value = mastery1Select.value;
        for (const option of mastery1Select.options) {
            if (option.value === 'none') continue;
            const hasBuilds = buildData[option.value] && Object.keys(buildData[option.value]).length > 0;
            option.disabled = !hasBuilds;
        }
        if (m1Value !== 'none' && buildData[m1Value]) {
            for (const option of mastery2Select.options) {
                const buildExists = buildData[m1Value][option.value];
                option.disabled = !buildExists;
            }
        }
    }

    mastery1Select.addEventListener('change', () => {
        const selectedValue = mastery1Select.value;
        mastery2Select.innerHTML = '';
        
        const masteryOptions = Object.keys(langStrings.masteryNames);
        masteryOptions.forEach(key => {
            const option = document.createElement('option');
            option.value = key;
            option.textContent = langStrings.masteryNames[key];
            mastery2Select.appendChild(option);
        });

        if (selectedValue === 'none') {
            mastery2Select.disabled = true;
        } else {
            mastery2Select.disabled = false;
            const isPrimaryExclusive = exclusiveMasteries.includes(selectedValue);
            const relatedSpecialization = specializationMap[selectedValue];
            Array.from(mastery2Select.options).forEach(option => {
                const isOptionExclusive = exclusiveMasteries.includes(option.value);
                if (option.value === selectedValue || (isPrimaryExclusive && isOptionExclusive) || option.value === relatedSpecialization) {
                    option.remove();
                }
            });
        }
        mastery2Select.value = 'none';
        updateMasteryAvailability();
        updateFindButtonState();
    });
    
    mastery2Select.addEventListener('change', updateFindButtonState);

    findBuildBtn.addEventListener('click', () => {
        const m1 = mastery1Select.value;
        const m2 = mastery2Select.value;
        buildResultsDiv.classList.add('hidden');
        feedbackMessageDiv.classList.add('hidden');
        
        if (m1 === 'none') {
            showFeedback(langStrings.feedbackSelectMastery);
            return;
        }
        
        const build = buildData[m1] && buildData[m1][m2];
        if (build) {
            displayBuild(build);
        } else {
            const m1Text = langStrings.masteryNames[m1];
            if (m2 === 'none') {
                showFeedback(langStrings.feedbackNotFoundMastery.replace('{m1}', m1Text));
            } else {
                const m2Text = langStrings.masteryNames[m2];
                showFeedback(langStrings.feedbackNotFoundCombination.replace('{m1}', m1Text).replace('{m2}', m2Text));
            }
        }
    });

    focusSelect.addEventListener('change', () => {
        const selectedFocus = focusSelect.value;
        if (currentDisplayedBuild && currentDisplayedBuild.focuses && currentDisplayedBuild.focuses[selectedFocus]) {
            const focusData = currentDisplayedBuild.focuses[selectedFocus];
            renderAttributes(focusData.stats);
            renderJutsus(focusData.jutsuOrder);
        }
    });

    guildBonusToggle.addEventListener('change', () => {
        isGuildBonusActive = guildBonusToggle.checked;
        const selectedFocus = focusSelect.value;
        if (currentDisplayedBuild && currentDisplayedBuild.focuses && currentDisplayedBuild.focuses[selectedFocus]) {
            const focusData = currentDisplayedBuild.focuses[selectedFocus];
            renderAttributes(focusData.stats);
        }
    });
    
    function renderAttributes(attributesArray) {
        const attributesTableBody = document.getElementById('attributes-table-body');
        attributesTableBody.innerHTML = '';
        
        attributesArray.forEach(stat => {
            const strBonus = isGuildBonusActive ? Math.floor(stat.str * 0.1) : 0;
            const staBonus = isGuildBonusActive ? Math.floor(stat.sta * 0.1) : 0;
            const intelBonus = isGuildBonusActive ? Math.floor(stat.intel * 0.1) : 0;
            const agiBonus = isGuildBonusActive ? Math.floor(stat.agi * 0.1) : 0;
            const chakraBonus = isGuildBonusActive ? Math.floor(stat.chakra * 0.1) : 0;
            
            const staWithBonus = stat.sta + staBonus;
            const chakraWithBonus = stat.chakra + chakraBonus;
            const health = 250 + (staWithBonus - 5) * 8;
            const chakraPool = 50 + (chakraWithBonus - 5) * 5;

            const strBonusDisplay = isGuildBonusActive && strBonus > 0 ? ` <span class="text-orange-400 text-xs font-normal">(+${strBonus})</span>` : '';
            const staBonusDisplay = isGuildBonusActive && staBonus > 0 ? ` <span class="text-orange-400 text-xs font-normal">(+${staBonus})</span>` : '';
            const intelBonusDisplay = isGuildBonusActive && intelBonus > 0 ? ` <span class="text-orange-400 text-xs font-normal">(+${intelBonus})</span>` : '';
            const agiBonusDisplay = isGuildBonusActive && agiBonus > 0 ? ` <span class="text-orange-400 text-xs font-normal">(+${agiBonus})</span>` : '';
            const chakraBonusDisplay = isGuildBonusActive && chakraBonus > 0 ? ` <span class="text-orange-400 text-xs font-normal">(+${chakraBonus})</span>` : '';

            const row = `<tr>
                <td class="p-2 text-sm text-slate-300 font-bold text-left">${stat.level}</td>
                <td class="p-2 text-sm text-slate-300">${stat.str}${strBonusDisplay}</td>
                <td class="p-2 text-sm text-slate-300">${stat.sta}${staBonusDisplay}</td>
                <td class="p-2 text-sm text-slate-300">${stat.intel}${intelBonusDisplay}</td>
                <td class="p-2 text-sm text-slate-300">${stat.agi}${agiBonusDisplay}</td>
                <td class="p-2 text-sm text-slate-300">${stat.chakra}${chakraBonusDisplay}</td>
                <td class="p-2 text-sm text-slate-300 font-semibold text-green-400">${health}</td>
                <td class="p-2 text-sm text-slate-300 font-semibold text-blue-400">${chakraPool}</td>
            </tr>`;
            attributesTableBody.innerHTML += row;
        });
    }

    function renderJutsus(jutsuArray) {
        jutsuTableBody.innerHTML = '';
        for (let i = 1; i <= 20; i++) {
            const jutsu = jutsuArray[i - 1];
            let slotNumber;
            if (i <= 17) {
                slotNumber = i;
            } else {
                slotNumber = `<span class="text-yellow-400 font-semibold">${langStrings.slotExtra.replace('{num}', i - 17)}</span>`;
            }
            const level = jutsu ? jutsu.level : '-';
            const name = jutsu ? getTranslated(jutsu, 'name') : `<i class="text-slate-500">${langStrings.slotEmpty}</i>`;
            const howToGet = jutsu ? getTranslated(jutsu, 'howToGet') : '-';
            const row = `<tr class="hover:bg-slate-700/50"><td class="p-3 text-sm text-slate-200 font-bold">${slotNumber}</td><td class="p-3 text-sm text-slate-300">${level}</td><td class="p-3 text-sm text-slate-300">${name}</td><td class="p-3 text-sm text-slate-400">${howToGet}</td></tr>`;
            jutsuTableBody.innerHTML += row;
        }
    }

    function updateBadge(badgeElement, isOk) {
        if (isOk) {
            badgeElement.textContent = langStrings.statusOk;
            badgeElement.className = 'px-2 py-0.5 text-xs font-bold rounded-full bg-green-600 text-white';
        } else {
            badgeElement.textContent = langStrings.statusPending;
            badgeElement.className = 'px-2 py-0.5 text-xs font-bold rounded-full bg-yellow-500 text-slate-900';
        }
    }

    function displayBuild(build) {
        currentDisplayedBuild = build;
        const bonusContainer = document.getElementById('guild-bonus-container');
        bonusContainer.classList.remove('hidden');

        // Status Overview
        const statusOverview = document.getElementById('build-status-overview');
        const attrBadge = document.getElementById('status-attributes-badge');
        const jutsuBadge = document.getElementById('status-jutsus-badge');
        const itemsBadge = document.getElementById('status-items-badge');
        
        const focusDataForStatus = build.focuses[Object.keys(build.focuses)[0]];
        const areAttributesOk = focusDataForStatus && focusDataForStatus.stats && focusDataForStatus.stats.length > 1;
        updateBadge(attrBadge, areAttributesOk);
        const areJutsusOk = focusDataForStatus && focusDataForStatus.jutsuOrder && focusDataForStatus.jutsuOrder.length >= 17;
        updateBadge(jutsuBadge, areJutsusOk);
        const areItemsOk = Object.values(build.items).some(item => getTranslated(item, 'name') !== '-');
        updateBadge(itemsBadge, areItemsOk);
        
        const createdBySection = document.getElementById('created-by-section');
        if (build.createdBy && build.createdBy.name) {
            document.getElementById('creator-name').textContent = build.createdBy.name;
            document.getElementById('creator-village').textContent = getTranslated(build.createdBy, 'village') || '-';
            document.getElementById('creator-rank').textContent = getTranslated(build.createdBy, 'rank') || '-';
            document.getElementById('creator-org').textContent = getTranslated(build.createdBy, 'org') || '-';
            createdBySection.classList.remove('hidden');
        } else {
            createdBySection.classList.add('hidden');
        }
        
        const buildInfoSection = document.getElementById('build-info-section');
        if (build.version || build.date) {
            document.getElementById('build-version').textContent = build.version || '-';
            document.getElementById('build-date').textContent = build.date || '-';
            buildInfoSection.classList.remove('hidden');
        } else {
            buildInfoSection.classList.add('hidden');
        }


        statusOverview.classList.remove('hidden');


        if (build.focuses && Object.keys(build.focuses).length > 1) {
            const currentFocusValue = focusSelect.value;
            
            focusContainer.classList.remove('hidden');
            focusSelect.innerHTML = '';
            const focusOptions = Object.keys(build.focuses);
            focusOptions.forEach(focusName => {
                const option = document.createElement('option');
                option.value = focusName;
                const translationKey = `focus${focusName.charAt(0).toUpperCase() + focusName.slice(1)}`;
                option.textContent = langStrings[translationKey] || focusName;
                focusSelect.appendChild(option);
            });

            if (currentFocusValue && build.focuses[currentFocusValue]) {
                focusSelect.value = currentFocusValue;
            } else {
                focusSelect.value = focusOptions[0];
            }
            
            const focusData = build.focuses[focusSelect.value];
            renderAttributes(focusData.stats);
            renderJutsus(focusData.jutsuOrder);
        } else {
            focusContainer.classList.add('hidden');
            const focusData = build.focuses[Object.keys(build.focuses)[0]];
            renderAttributes(focusData.stats);
            renderJutsus(focusData.jutsuOrder);
        }

        itemsTableBody.innerHTML = '';
        for (const [category, itemData] of Object.entries(build.items)) {
            const row = `<tr class="hover:bg-slate-700/50">
                            <td class="p-3 text-sm text-orange-400 font-semibold">${langStrings.itemTypes[category] || category}</td>
                            <td class="p-3 text-sm text-slate-300">${getTranslated(itemData, 'name')}</td>
                            <td class="p-3 text-sm text-slate-300">${getTranslated(itemData, 'dmg')}</td>
                            <td class="p-3 text-sm text-slate-300">${getTranslated(itemData, 'attr')}</td>
                            <td class="p-3 text-sm text-slate-300">${getTranslated(itemData, 'effect')}</td>
                            <td class="p-3 text-sm text-slate-400">${getTranslated(itemData, 'obs')}</td>
                        </tr>`;
            itemsTableBody.innerHTML += row;
        }

        buildResultsDiv.classList.remove('hidden');
        buildResultsDiv.classList.add('fade-in');
    }

    function showFeedback(message) {
        feedbackMessageDiv.textContent = message;
        feedbackMessageDiv.classList.remove('hidden');
        document.getElementById('guild-bonus-container').classList.add('hidden');
        document.getElementById('build-status-overview').classList.add('hidden');
        feedbackMessageDiv.classList.add('fade-in');
    }
    
    // --- INITIALIZATION ---
    function getInitialLanguage() {
        const savedLang = localStorage.getItem('ninBuildsLang');
        if (savedLang && translations[savedLang]) {
            return savedLang;
        }
        const browserLang = (navigator.language || navigator.userLanguage).toLowerCase();
        return browserLang === 'pt-br' ? 'pt-BR' : 'en';
    }

    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            setLanguage(btn.dataset.lang);
        });
    });
    
    setLanguage(getInitialLanguage());
});
</script>

</body>
</html>

